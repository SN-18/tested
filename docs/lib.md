
# lib.lua

Misc tricks.

Some general LUA tricks.    	
(c)2022 Tim Menzies <timm@ieee.org> BSD-2 license	
## Linting	



  
**_l.rogues() &rArr;  nil_**  
&nbsp;&nbsp;&nbsp;&nbsp; report rogue locals    



## Maths	



  
**_l.max(...) &rArr;  n_**  
&nbsp;&nbsp;&nbsp;&nbsp; return max    
  
**_l.min(...) &rArr;  n_**  
&nbsp;&nbsp;&nbsp;&nbsp; return min    
  
**_l.same(x, ...) &rArr;  x_**  
&nbsp;&nbsp;&nbsp;&nbsp; return `x` unmodified    
  
**_l.per(t:<tt>tab</tt>, p) &rArr;  num_**  
&nbsp;&nbsp;&nbsp;&nbsp; return the `p`th(=.5) item of sorted list `t`    
  
**_l.pers(t:<tt>tab</tt>, nps:<tt>{num}</tt>) &rArr;  t_**  
&nbsp;&nbsp;&nbsp;&nbsp; return the `nps` items of sorted list `t`    



### Random number generator	
The LUA doco says its random number generator is not stable across platforms.	
Hence, we use our own (using Park-Miller).	



  
**_l.srand(n:<tt>num</tt>) &rArr;  nil_**  
&nbsp;&nbsp;&nbsp;&nbsp; reset random number seed (defaults to 937162211)     
  
**_l.rand(nlo:<tt>num</tt>, nhi:<tt>num</tt>) &rArr;  num_**  
&nbsp;&nbsp;&nbsp;&nbsp; return float from `nlo`..`nhi` (default 0..1)    
  
**_l.rint(nlo:<tt>num</tt>, nhi:<tt>num</tt>) &rArr;  int_**  
&nbsp;&nbsp;&nbsp;&nbsp; returns integer from `nlo`..`nhi` (default 0..1)    



## Lists	



  
**_l.list(t:<tt>tab</tt>) &rArr;  t_**  
&nbsp;&nbsp;&nbsp;&nbsp; ensure `t` has indexes `1.. size(t)`    
  
**_l.any(t:<tt>tab</tt>) &rArr;  any_**  
&nbsp;&nbsp;&nbsp;&nbsp; return any item from `t`, picked at random    
  
**_l.many(t:<tt>tab</tt>, n:<tt>num</tt>) &rArr;  t_**  
&nbsp;&nbsp;&nbsp;&nbsp; return `n` items from `t`, picked at random    
  
**_l.shuffle(t:<tt>tab</tt>,    j?) &rArr;  t_**  
&nbsp;&nbsp;&nbsp;&nbsp;  Randomly shuffle, in place, the list `t`.    
  
**_l.copy(t:<tt>tab</tt>) &rArr;  t_**  
&nbsp;&nbsp;&nbsp;&nbsp; return a deep copy of `t.    
  
**_l.push(t:<tt>tab</tt>,  x) &rArr;  any_**  
&nbsp;&nbsp;&nbsp;&nbsp; push `x` to end of list; return `x`     
  
**_l.slice(t:<tt>tab</tt>,  go,  stop:<tt>str</tt>,  inc) &rArr;  t_**  
&nbsp;&nbsp;&nbsp;&nbsp; return `t` from `go`(=1) to `stop`(=#t), by `inc`(=1)    



### Meta	



  
**_l.kap(t:<tt>tab</tt>,  fun:<tt>fun</tt>) &rArr;  t_**  
&nbsp;&nbsp;&nbsp;&nbsp; map function `fun`(k,v) over list (skip nil results)     
  
**_l.keys(t:<tt>tab</tt>) &rArr;  t_**  
&nbsp;&nbsp;&nbsp;&nbsp; sort+return `t`'s keys (ignore things with leading `_`)    
  
**_l.map(t:<tt>tab</tt>,  fun:<tt>fun</tt>) &rArr;  t_**  
&nbsp;&nbsp;&nbsp;&nbsp; map function `fun`(v) over list (skip nil results)     



### Sorting Lists	



  
**_l.gt(s:<tt>str</tt>) &rArr;  fun_**  
&nbsp;&nbsp;&nbsp;&nbsp; return a function that sorts ascending on `s'.    
  
**_l.lt(s:<tt>str</tt>) &rArr;  fun_**  
&nbsp;&nbsp;&nbsp;&nbsp; return a function that sorts descending on `s`.    
  
**_l.sort(t:<tt>tab</tt>,  fun:<tt>fun</tt>) &rArr;  t_**  
&nbsp;&nbsp;&nbsp;&nbsp; return `t`,  sorted by `fun` (default= `<`)    



## Coercion	
### Strings to Things	



  
**_l.coerce(s:<tt>str</tt>) &rArr;  any_**  
&nbsp;&nbsp;&nbsp;&nbsp; return int or float or bool or string from `s`    
  
**_l.settings(s:<tt>str</tt>) &rArr;  t_**  
&nbsp;&nbsp;&nbsp;&nbsp;  parse help string to extract a table of options    
  
**_l.csv(sFilename:<tt>str</tt>, fun:<tt>fun</tt>) &rArr;  nil_**  
&nbsp;&nbsp;&nbsp;&nbsp; call `fun` on rows (after coercing cell text)    



### Things to Strings	



  
**_l.fmt(sControl:<tt>str</tt>, ...) &rArr;  str_**  
&nbsp;&nbsp;&nbsp;&nbsp; emulate printf    
  
**_l.oo(t:<tt>tab</tt>) &rArr;  nil_**  
&nbsp;&nbsp;&nbsp;&nbsp; print `t`'s string (the one generated by `o`)    
  
**_l.o(t:<tt>tab</tt>,   seen:<tt>str</tt>?) &rArr;  str_**  
&nbsp;&nbsp;&nbsp;&nbsp; table to string (recursive)    



## Objects	



  
**_l.obj(s:<tt>str</tt>) &rArr;  t_**  
&nbsp;&nbsp;&nbsp;&nbsp; create a klass and a constructor + print method    



### Start-up stuff	



  
**_l.cli(options:<tt>tab</tt>) &rArr;  t_**  
&nbsp;&nbsp;&nbsp;&nbsp; update key,vals in `t` from command-line flags    
  
**_l.run1(options:<tt>tab</tt>, fun:<tt>fun</tt>) &rArr; x_**  
&nbsp;&nbsp;&nbsp;&nbsp; reset seed; call `fun`; afterwards, reset config    



